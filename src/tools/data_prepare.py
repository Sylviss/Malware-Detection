from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import AdaBoostClassifier
from sklearn.model_selection import train_test_split, learning_curve
from sklearn.metrics import accuracy_score, confusion_matrix, recall_score, f1_score
from tqdm import tqdm
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sb

def data_split(classify_type):
    datasets = r"../Datasets/ClaMP_In_Selected.csv"
    df = pd.read_csv(datasets)
    df2 = pd.read_csv(r"../Datasets/ClaMP_In_Selected_Test.csv")

    if classify_type == "multiclass":
        df3 = pd.read_csv(r"../Datasets/ClaMP_In_Selected_Additional.csv")
        df = pd.concat([df,df3])
    df2 = df2.sample(frac = 1)
    # Seperate the data
    X_hehe,y = df.drop(columns=["class"]).to_numpy(), df["class"].to_numpy()
    X_hehe_2, y_true = df2.drop(columns=["class"]).to_numpy(), df2["class"].to_numpy()

    if classify_type == "binary":
        for i,label in enumerate(y):
            if label!=0:
                y[i]=1
        for i,label in enumerate(y_true):
            if label!=0:
                y_true[i]=1
    return X_hehe, y, X_hehe_2, y_true
            
def data_preprocess_basic(X_hehe, y, X_hehe_2, y_true):
    scaler = StandardScaler()
    scaler.fit(X_hehe)
    X = scaler.transform(X_hehe)
    X_true = scaler.transform(X_hehe_2)
    X_train, X_test, y_train, y_test = train_test_split(X,y, random_state = 16, test_size = 0.25)
    X_true, X_valid, y_true, y_valid = train_test_split(X_true,y_true, random_state = 16, test_size = 0.25)
    return X_train, X_test, y_train, y_test, X_true, X_valid, y_true, y_valid

def data_preprocess_ohe(X_hehe, y, X_hehe_2, y_true):
    pass